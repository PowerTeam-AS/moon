# moon
U-14 to U-23

U-14~U-23 / 점검 로직 구조 / # TODO : 추후 조치 추가
==========================================
U-14 >>> root 홈, 패스 디렉터리 권한 및 패스 설정
점검 내용 : root 계정의 PATH 환경변수에 "."이 포함 여부 점검
1. root 권한 확인
1-1. PATH 맨 앞에 '.' 이 존재 하는가?
1-2. PATH 중간에 '.'이 존재 하는가?
1-3. 빈 경로(::)가 존재하는가? (Linux는 :: == .)

2. 결과 출력
==========================================
U-15 >>> 파일 및 디렉터리 소유자 설정
점검 내용 : 소유자가 존재하지 않는 파일 및 디렉토리 존재 여부 점검
추가 정의 : mktemp (임시파일 저장)

1. 시스템 전체 스캔 (소유자, 그룹이 없는 파일들을 점검)
find / -xdev \( -nouser -o -nogroup \) -print > "$TMP_LIST" 2>/dev/null

2. 결과 출력
==========================================
U-16 >>> 파일 소유자 및 권한 설정
점검 내용 : /etc/passwd 파일 권한 적절성 여부 점검
추가 정의 : TARGET_FILE="/etc/passwd"

1. 파일 존재 여부 확인 -> 파일 정보 추출
1-1. 소유자 확인 (root 인지)
1-2. 권한 확인 (644?)
  PERM_STR="${F_PERM: -3}"
  PERM_G="${PERM_STR:1:1}" # Group
  PERM_O="${PERM_STR:2:1}" # Other

2. 결과 출력
==========================================
U-17 >>> 시스템 시작 스크립트 권한 설정
점검 내용 : 시스템 시작 스크립트(/etc/rc.d/*)의 소유자가 root이고, Other에게 쓰기 권한이 없는지 점검
추가 정의 : TARGET_DIR="/etc/rc.d"

1. 점검 대상 디렉터리 존재 확인
2. 파일 점검 루프
2-1. 소유가 root 확인
2-2. 권한 확인
3. 결과 출력
==========================================
U-18 >>> /etc/shadow 파일 소유자 및 권한 설정
점검 내용 : /etc/shadow 파일 권한 적절성 여부 점검
추가 정의 : TARGET_FILE="/etc/shadow"

1. 파일 존재 여부 확인
2. 파일 정보 추출
2-1. 소유자 확인(root)
2-2. 권한 확인 (400)
    if [ "$F_PERM" -gt 400 ]; then
      IS_VULN=1
      if [[ -n "$VULN_REASON" ]]; then VULN_REASON="${VULN_REASON}, "; fi
      VULN_REASON="${VULN_REASON}Perm_is_greater_than_400($F_PERM)"
    fi
3. 결과 출력
==========================================
U-19 >>> /etc/hosts 파일 소유자 및 권한 설정
점검 내용 : /etc/hosts 파일의 권한 적절성 여부 점검
추가 정의 : TARGET_FILE="/etc/hosts"

1. 파일 존재 여부 확인
2. 파일 정보 추출
2-1. 소유자 확인 (root)
2-2. 권한확인 (644)
3. 결과 출력
==========================================
U-20 >>> /etc/(x)inetd.conf 파일 소유자 및 권한 설정
점검 내용 : /etc/(x)inetd.conf 파일 권한 적절성 여부 점검
추가 정의 :
CHECK_TARGETS=(
  "/etc/inetd.conf"
  "/etc/xinetd.conf"
  "/etc/systemd/system.conf"
)

1. 추가 정의
2. 파일 점검 루프 / 파일 정보 추출
2-1. 소유자 확인 (root)
2-2. 권한 확인 (600 이하)
3. 결과 출력
==========================================
U-21 >>> /etc/(r)syslog.conf 파일 소유자 및 권한 설정
점검 내용 : /etc/(r)syslog.conf 파일 권한 적절성 여부 점검
추가 정의 :
CHECK_TARGETS=(
  "/etc/syslog.conf"
  "/etc/rsyslog.conf"
)

1. 파일 점검 루프 / 파일 정보 추출
1-1. 소유자 확인 (root)
1-2. 권한 확인 (640 이하)
2. 결과 출력
==========================================
U-22 >>> /etc/services 파일 소유자 및 권한 설정
점검 내용 : /etc/services 파일 권한 적절성 여부 점검
추가 정의 : TARGET_FILE="/etc/services"

1. 파일 존재 여부 확인
2. 파일 정보 추출
2-1. 소유자 확인
2-2. 권한 확인 (644 이하)
3. 결과 출력
==========================================
U-23 >>> SUID, SGID, Sticky bit 설정 파일 점검
점검 내용 : 불필요하거나 악의적인 파일에 SUID, SGID, Sticky bit 설정 여부 점검

1. SUID/SGID 파일 검색
2. 결과 출력
==========================================
